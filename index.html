<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>xuguan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="python, c++, c, matlab, gunplot, osgi, omnet++4.x,">
<meta property="og:type" content="website">
<meta property="og:title" content="xuguan">
<meta property="og:url" content="http://xuguan.github.io/index.html">
<meta property="og:site_name" content="xuguan">
<meta property="og:description" content="python, c++, c, matlab, gunplot, osgi, omnet++4.x,">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="xuguan">
<meta name="twitter:description" content="python, c++, c, matlab, gunplot, osgi, omnet++4.x,">
  
    <link rel="alternate" href="/atom.xml" title="xuguan" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">xuguan</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Coding style</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://xuguan.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-monitorHTTP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/02/monitorHTTP/" class="article-date">
  <time datetime="2016-06-02T09:31:28.000Z" itemprop="datePublished">2016-06-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Code/">Code</a>►<a class="article-category-link" href="/categories/Code/script/">script</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/02/monitorHTTP/">monitorHTTP</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="A-simle-way-to-find-your-most-recent-online-http-services"><a href="#A-simle-way-to-find-your-most-recent-online-http-services" class="headerlink" title="A simle way to find your most recent online http services"></a>A simle way to find your most recent online http services</h1><p>After the <code>tcpdump</code> captures the HTTP traffic, we can find the most recent or frequently accessing web services. Although some HTTP sessions have no Host field, we calcuate and export the frequence of each Host for simplicity.</p>
<h2 id="tcpdump-http-sessions"><a href="#tcpdump-http-sessions" class="headerlink" title="tcpdump http sessions"></a>tcpdump http sessions</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tcpdump tcp -i eth3 -t <span class="_">-s</span> 0 -c 100000000 and dst port ! 22 and src net 10.20.31.0/24 and tcp[20:2]=0x4745 or tcp[20:2]=0x4854 -w /tmp/tcpdumpSave.cap</span><br></pre></td></tr></table></figure>
<h2 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep <span class="_">-a</span> /tmp/tcpdumpSave.cap |awk <span class="string">'&#123;print $2&#125;'</span> &gt; tcpdumpGrepHost.txt</span><br></pre></td></tr></table></figure>
<p>where <code>-a</code> means to ‘Process a binary file as if it were text’.</p>
<h2 id="google-wordcount-py"><a href="#google-wordcount-py" class="headerlink" title="google-wordcount.py"></a>google-wordcount.py</h2><p>I exploit the wordcount written by <a href="https://github.com/aysin/wordCount/blob/master/.py" target="_blank" rel="external">aysin</a>, which only work with the option <code>--count</code> here.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./google-wordcount.py --count tcpdumpGrepHost.txt |sort -n -k 2 -r &gt;tcpdumpCount.txt</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://xuguan.github.io/2016/06/02/monitorHTTP/" data-id="cioy4teai0004c8uxajc2ukq2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/awk/">awk</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bash/">bash</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/grep/">grep</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tcpdump/">tcpdump</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-odl全局实例" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/29/odl全局实例/" class="article-date">
  <time datetime="2016-05-29T06:10:28.000Z" itemprop="datePublished">2016-05-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Code/">Code</a>►<a class="article-category-link" href="/categories/Code/howToUse/">howToUse</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/odl全局实例/">odl全局实例</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="插件的注册与调用"><a href="#插件的注册与调用" class="headerlink" title="插件的注册与调用"></a>插件的注册与调用</h1><h2 id="调用全局实例"><a href="#调用全局实例" class="headerlink" title="调用全局实例"></a>调用全局实例</h2><h3 id="方法1：ServiceHelper-getGlobalInstance"><a href="#方法1：ServiceHelper-getGlobalInstance" class="headerlink" title="方法1：ServiceHelper.getGlobalInstance"></a>方法1：ServiceHelper.getGlobalInstance</h3><p>在mapreduceimpl.java代码中，我们用到了全局实例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">routing = (IRouting) ServiceHelper.getGlobalInstance(IRouting.class, <span class="keyword">this</span>);</span><br></pre></td></tr></table></figure>
<p>这里，<code>getGlobalInstance</code>函数定义为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"></span><br><span class="line"> * Retrieve global instance of a class via OSGI registry, if</span><br><span class="line"></span><br><span class="line"> * there are many only the first is returned.</span><br><span class="line"></span><br><span class="line"> *</span><br><span class="line"></span><br><span class="line"> * <span class="doctag">@param</span> clazz The target class</span><br><span class="line"></span><br><span class="line"> * <span class="doctag">@param</span> bundle The caller</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getGlobalInstance</span><span class="params">(Class&lt;?&gt; clazz, Object bundle)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> getGlobalInstance(clazz, bundle, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过OSGI registry来获取全局实例！该<code>ServiceHelper</code>方法用于注册和查询OSGI service registry</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> org.opendaylight.controller.sal.utils;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"></span><br><span class="line"> * The class helps to register and retrieve OSGi service registry</span><br><span class="line"></span><br><span class="line"> *</span><br><span class="line"></span><br><span class="line"> *</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceHelper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>注册OSGI service registry时需要一个该实例的4个参数：类型、容器名、实例指针、文件夹属性。</p>
<p>例如,在SwitchNorthbound.java中的<code>private boolean isValidContainer(String containerName)</code>函数，通过ServiceHelper检索了一个IContainerManager类型的实例，代码如下，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> org.opendaylight.controller.switchmanager.northbound;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.Consumes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.DELETE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.GET;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.POST;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.PUT;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.Path;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.PathParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.Produces;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.QueryParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.core.Context;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.core.MediaType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.core.Response;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.core.SecurityContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.core.UriInfo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.ws.rs.ext.ContextResolver;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.codehaus.enunciate.jaxrs.ResponseCode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.codehaus.enunciate.jaxrs.StatusCodes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.codehaus.enunciate.jaxrs.TypeHint;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.containermanager.IContainerManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.northbound.commons.RestMessages;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.northbound.commons.exception.InternalServerErrorException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.northbound.commons.exception.ResourceNotFoundException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.northbound.commons.exception.ServiceUnavailableException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.northbound.commons.exception.UnauthorizedException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.northbound.commons.query.QueryContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.northbound.commons.utils.NorthboundUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.authorization.Privilege;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.core.Node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.core.NodeConnector;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.core.Property;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.utils.GlobalConstants;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.utils.ServiceHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.utils.Status;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.utils.StatusCode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.switchmanager.ISwitchManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.switchmanager.SwitchConfig;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"></span><br><span class="line"> * The class provides Northbound REST APIs to access the nodes, node connectors</span><br><span class="line"></span><br><span class="line"> * and their properties.</span><br><span class="line"></span><br><span class="line"> *</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Path</span>(<span class="string">"/"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwitchNorthbound</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> QueryContext queryContext;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Context</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQueryContext</span><span class="params">(ContextResolver&lt;QueryContext&gt; queryCtxResolver)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (queryCtxResolver != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">        queryContext = queryCtxResolver.getContext(QueryContext.class);</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">isValidContainer</span><span class="params">(String containerName)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (containerName.equals(GlobalConstants.DEFAULT.toString())) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        IContainerManager containerManager = (IContainerManager) ServiceHelper.getGlobalInstance(</span><br><span class="line"></span><br><span class="line">                IContainerManager.class, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (containerManager == <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> InternalServerErrorException(RestMessages.INTERNALERROR.toString());</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (containerManager.getContainerNames().contains(containerName)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>以上例子中的最后一部分代码摘抄下来</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">IContainerManager containerManager = (IContainerManager) ServiceHelper.getGlobalInstance( IContainerManager.class, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (containerManager.getContainerNames().contains(containerName)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第一行查询containerManager，如果不存在则返回null，说明容器管理器不存在，如果存在则可以进入第二行，继续处理。</p>
<p>第二行判断该类型的实例，其容器名是否与要查询的<code>containerName</code>相同，进行判断。</p>
<p>下面有了一个问题</p>
<blockquote>
<p><code>IContainerManager.class</code>的实例在什么地方进行注册的呢？</p>
</blockquote>
<p>我们先搁置下，看看如何查询<code>containerName</code>的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line"></span><br><span class="line">     *</span><br><span class="line"></span><br><span class="line">     * Retrieve a list of all the nodeconnectors and their properties in a given</span><br><span class="line"></span><br><span class="line">     * node</span><br><span class="line"></span><br><span class="line">     *</span><br><span class="line"></span><br><span class="line">     * <span class="doctag">@param</span> containerName</span><br><span class="line"></span><br><span class="line">     *            The container for which we want to retrieve the list (Eg.</span><br><span class="line"></span><br><span class="line">     *            'default')</span><br><span class="line"></span><br><span class="line">     * <span class="doctag">@param</span> nodeType</span><br><span class="line"></span><br><span class="line">     *            Type of the node being programmed (Eg. 'OF')</span><br><span class="line"></span><br><span class="line">     * <span class="doctag">@param</span> nodeId</span><br><span class="line"></span><br><span class="line">     *            Node Identifier as specified by</span><br><span class="line"></span><br><span class="line">     *            &#123;<span class="doctag">@link</span> org.opendaylight.controller.sal.core.Node&#125; (Eg.</span><br><span class="line"></span><br><span class="line">     *            '00:00:00:00:00:00:00:03')</span><br><span class="line"></span><br><span class="line">     * <span class="doctag">@return</span> A List of Pair each pair represents a</span><br><span class="line"></span><br><span class="line">     *         &#123;<span class="doctag">@link</span> org.opendaylight.controller.sal.core.NodeConnector&#125; and</span><br><span class="line"></span><br><span class="line">     *         its corresponding</span><br><span class="line"></span><br><span class="line">     *         &#123;<span class="doctag">@link</span> org.opendaylight.controller.sal.core.Property&#125; attached to</span><br><span class="line"></span><br><span class="line">     *         it.</span><br><span class="line"></span><br><span class="line">     *</span><br><span class="line"></span><br><span class="line">     * &lt;pre&gt;</span><br><span class="line"></span><br><span class="line">     *</span><br><span class="line"></span><br><span class="line">     * Example:</span><br><span class="line"></span><br><span class="line">     *</span><br><span class="line"></span><br><span class="line">     * Request URL:</span><br><span class="line"></span><br><span class="line">     * http://localhost:8080/controller/nb/v2/switchmanager/default/node/OF/00:00:00:00:00:00:00:01</span><br><span class="line"></span><br><span class="line">     *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Path</span>(<span class="string">"/&#123;containerName&#125;/node/&#123;nodeType&#125;/&#123;nodeId&#125;"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GET</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Produces</span>(&#123; MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TypeHint</span>(NodeConnectors.class)</span><br><span class="line"></span><br><span class="line">    <span class="meta">@StatusCodes</span>(&#123; <span class="meta">@ResponseCode</span>(code = <span class="number">200</span>, condition = <span class="string">"Operation successful"</span>),</span><br><span class="line"></span><br><span class="line">        <span class="meta">@ResponseCode</span>(code = <span class="number">401</span>, condition = <span class="string">"User not authorized to perform this operation"</span>),</span><br><span class="line"></span><br><span class="line">        <span class="meta">@ResponseCode</span>(code = <span class="number">404</span>, condition = <span class="string">"The containerName is not found"</span>),</span><br><span class="line"></span><br><span class="line">        <span class="meta">@ResponseCode</span>(code = <span class="number">503</span>, condition = <span class="string">"One or more of Controller Services are unavailable"</span>),</span><br><span class="line"></span><br><span class="line">        <span class="meta">@ResponseCode</span>(code = <span class="number">400</span>, condition = <span class="string">"Incorrect query syntex"</span>) &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> NodeConnectors <span class="title">getNodeConnectors</span><span class="params">(@PathParam(<span class="string">"containerName"</span>)</span> String containerName,</span><br><span class="line"></span><br><span class="line">            @<span class="title">PathParam</span><span class="params">(<span class="string">"nodeType"</span>)</span> String nodeType, @<span class="title">PathParam</span><span class="params">(<span class="string">"nodeId"</span>)</span> String nodeId,</span><br><span class="line"></span><br><span class="line">            @<span class="title">QueryParam</span><span class="params">(<span class="string">"_q"</span>)</span> String queryString) </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!isValidContainer(containerName)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ResourceNotFoundException(<span class="string">"Container "</span> + containerName + <span class="string">" does not exist."</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>最后一行判断是对容器名的判断，一般在url中采用default字符串表示。在这里<code>switchmanager/default/node/OF/00:00:00:00:00:00:00:01</code> 是否理解成：访问<code>switchmanager</code>的<code>default</code>容器，就是<code>switchmanager</code>这个模块本身。</p>
<p>此处<code>containermanager</code>类型指示网络可以分割的数量</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> org.opendaylight.controller.containermanager;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.utils.Status;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"></span><br><span class="line"> * Container Manager provides an ability for the Network Administrators to</span><br><span class="line"></span><br><span class="line"> * partitions a production network into smaller, isolated and manageable</span><br><span class="line"></span><br><span class="line"> * networks. IContainerManager interface exposes these Container management capabilities</span><br><span class="line"></span><br><span class="line"> * via the supported APIs</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IContainerManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h4 id="容器名"><a href="#容器名" class="headerlink" title="容器名"></a>容器名</h4><p>下面看如何注册一个服务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> org.opendaylight.controller.sal.utils;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Hashtable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.osgi.framework.ServiceRegistration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Dictionary;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.osgi.framework.BundleContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.osgi.framework.FrameworkUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.osgi.framework.ServiceReference;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"></span><br><span class="line"> * The class helps to register and retrieve OSGi service registry</span><br><span class="line"></span><br><span class="line"> *</span><br><span class="line"></span><br><span class="line"> *</span><br><span class="line"></span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceHelper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory</span><br><span class="line"></span><br><span class="line">            .getLogger(ServiceHelper.class);</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line"></span><br><span class="line">     * Register a Global Service in the OSGi service registry</span><br><span class="line"></span><br><span class="line">     *</span><br><span class="line"></span><br><span class="line">     * <span class="doctag">@param</span> clazz The target class</span><br><span class="line"></span><br><span class="line">     * <span class="doctag">@param</span> instance of the object exporting the service, be careful</span><br><span class="line"></span><br><span class="line">     * the object must implement/extend clazz else the registration</span><br><span class="line"></span><br><span class="line">     * will fail unless a ServiceFactory is passed as parameter</span><br><span class="line"></span><br><span class="line">     * <span class="doctag">@param</span> properties The properties to be attached to the service</span><br><span class="line"></span><br><span class="line">     * registration</span><br><span class="line"></span><br><span class="line">     * <span class="doctag">@return</span> true if registration happened, false otherwise</span><br><span class="line"></span><br><span class="line">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">registerGlobalService</span><span class="params">(Class&lt;?&gt; clazz,</span><br><span class="line"></span><br><span class="line">                                                Object instance,</span><br><span class="line"></span><br><span class="line">                                                Dictionary&lt;String, Object&gt; properties)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ServiceRegistration&lt;?&gt; registration = registerGlobalServiceWReg(clazz, instance, properties);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (registration == <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">            logger.error(<span class="string">"Failed to register &#123;&#125; for instance &#123;&#125;"</span>, clazz, instance);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line"></span><br><span class="line">     * Retrieve global instance of a class via OSGI registry, if</span><br><span class="line"></span><br><span class="line">     * there are many only the first is returned.</span><br><span class="line"></span><br><span class="line">     *</span><br><span class="line"></span><br><span class="line">     * <span class="doctag">@param</span> clazz The target class</span><br><span class="line"></span><br><span class="line">     * <span class="doctag">@param</span> bundle The caller</span><br><span class="line"></span><br><span class="line">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getGlobalInstance</span><span class="params">(Class&lt;?&gt; clazz, Object bundle)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> getGlobalInstance(clazz, bundle, <span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>上面是服务注册的方法，看IContainerManager的实现，发现只是一个接口，里面定义了对所有<code>container</code>的管理，通过<code>public List&lt;String&gt; getContainerNameList();</code>查询所有容器的名字，通过<code>public Map&lt;String, List&lt;ContainerFlowConfig&gt;&gt; getContainerFlows();</code>查询在容器内配置的流。</p>
<blockquote>
<p>疑问？每个容器内可以配置多条流，还是每个容器里只配置一条流？</p>
</blockquote>
<p>具体在什么地方实现呢？</p>
<h3 id="方法2：session-getSALService"><a href="#方法2：session-getSALService" class="headerlink" title="方法2：session.getSALService"></a>方法2：session.getSALService</h3><p>对于该方法，在 <a href="http://sdntutorials.com/how-to-look-up-topology-and-links-in-md-sal" target="_blank" rel="external">http://sdntutorials.com/how-to-look-up-topology-and-links-in-md-sal</a> 中的例子，可以当做完美的演示！</p>
<p>该网文教我们如何实现查询拓扑，大概实现如下，</p>
<ol>
<li>在插件在会话初始化时，直接查询SAL服务，找到DataProviderService实例。例如，</li>
</ol>
<p>代码第46行 <code>dataProviderService = session.getSALService(DataProviderService.class);</code></p>
<p>可见ProviderContext会话在初始化前已经关联好与SAL服务的关系，现在可以直接使用getSALService方法。</p>
<ol>
<li>获取要读取数据的标识符，例如</li>
</ol>
<p><code>InstanceIdentifier topoIdentifier = InstanceIdentifier.builder(NetworkTopology.class).toInstance();</code></p>
<ol>
<li>调用DataProviderService实例中的方法来获取数据，根据数据的标识符，例如紧接着上面这个拓扑标识符，可以查询拓扑，</li>
</ol>
<p>`</p>
<p> List<topology> topos = ((NetworkTopology) this.dataProviderService.readOperationalData(topoIdentifier)).getTopology();    </topology></p>
<p>`</p>
<p>该网文完整地代码如下，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> org.opendaylight.testservice;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.binding.api.data.DataProviderService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.binding.api.AbstractBindingAwareProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.controller.sal.binding.api.BindingAwareBroker.ProviderContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.osgi.framework.BundleContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yangtools.yang.binding.InstanceIdentifier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.opendaylight.inventory.rev130819.NodeId;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.opendaylight.inventory.rev130819.Nodes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.opendaylight.inventory.rev130819.nodes.Node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.opendaylight.inventory.rev130819.nodes.NodeKey;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.tbd.params.xml.ns.yang.network.topology.rev131021.network.topology.topology.Link;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.tbd.params.xml.ns.yang.network.topology.rev131021.network.topology.Topology;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.tbd.params.xml.ns.yang.network.topology.rev131021.NetworkTopology;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.tbd.params.xml.ns.yang.network.topology.rev131021.network.topology.TopologyKey;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yang.gen.v1.urn.tbd.params.xml.ns.yang.network.topology.rev131021.TopologyId;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.opendaylight.yangtools.yang.binding.RpcService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestProvider</span> <span class="keyword">extends</span> <span class="title">AbstractBindingAwareProvider</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Logger LOG = LoggerFactory.getLogger(TestProvider.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> DataProviderService dataProviderService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestProvider</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Collection&lt;? extends RpcService&gt; getImplementations() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Collection&lt;? extends ProviderFunctionality&gt; getFunctionality() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSessionInitiated</span><span class="params">(ProviderContext session)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    	LOG.debug(<span class="string">"Test Plugin Started"</span>);</span><br><span class="line"></span><br><span class="line">    	dataProviderService = session.getSALService(DataProviderService.class);</span><br><span class="line"></span><br><span class="line">    	<span class="comment">// Get all nodes in MD-SAL</span></span><br><span class="line"></span><br><span class="line">    	List&lt;Node&gt; nodeList = getAllNodes();</span><br><span class="line"></span><br><span class="line">    	<span class="keyword">for</span> (Node node : nodeList) &#123;</span><br><span class="line"></span><br><span class="line">    		LOG.debug(<span class="string">"node : &#123;&#125;"</span>, node.toString());</span><br><span class="line"></span><br><span class="line">    	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    	<span class="comment">// Get a particular node in MD-SAL</span></span><br><span class="line"></span><br><span class="line">    	Node node2 = getNode(<span class="string">"node_001"</span>);</span><br><span class="line"></span><br><span class="line">    	LOG.debug(<span class="string">"node2 : &#123;&#125;"</span>, node2.toString());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    	<span class="comment">// Get all topologies in MD-SAL</span></span><br><span class="line"></span><br><span class="line">    	List&lt;Topology&gt; topoList = getAllTopologies();</span><br><span class="line"></span><br><span class="line">    	<span class="keyword">for</span> (Topology topo : topoList) &#123;</span><br><span class="line"></span><br><span class="line">    		LOG.debug(<span class="string">"topo : &#123;&#125;"</span>, topo.toString());</span><br><span class="line"></span><br><span class="line">    	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    	<span class="comment">// Get a particular toplogy in MD-SAL</span></span><br><span class="line"></span><br><span class="line">    	Topology flowTopo = getFlowTopology();</span><br><span class="line"></span><br><span class="line">    	LOG.debug(<span class="string">"flowTopo : &#123;&#125;"</span>, flowTopo.toString());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    	<span class="comment">// Get all links in MD-SAL</span></span><br><span class="line"></span><br><span class="line">    	List&lt;Link&gt; linkList = getAllLinks();</span><br><span class="line"></span><br><span class="line">    	<span class="keyword">for</span> (Link link : linkList) &#123;</span><br><span class="line"></span><br><span class="line">    		LOG.debug(<span class="string">"link : &#123;&#125;"</span>, link.toString());</span><br><span class="line"></span><br><span class="line">    	&#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">startImpl</span><span class="params">(BundleContext context)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get all nodes in MD-SAL</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> List&lt;Node&gt; <span class="title">getAllNodes</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		InstanceIdentifier&lt;Nodes&gt; nodesIdentifier = InstanceIdentifier.builder().node(Nodes.class).toInstance();</span><br><span class="line"></span><br><span class="line">		Nodes nodes = (Nodes) <span class="keyword">this</span>.dataProviderService.readOperationalData(nodesIdentifier);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> nodes.getNode();</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Get a particular node in MD-SAL</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> Node <span class="title">getNode</span><span class="params">(String nodeName)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		NodeId nodeId = <span class="keyword">new</span> NodeId(nodeName);</span><br><span class="line"></span><br><span class="line">		InstanceIdentifier instanceIdentifier = InstanceIdentifier.builder(Nodes.class).child(Node.class, <span class="keyword">new</span> NodeKey(nodeId)).toInstance();</span><br><span class="line"></span><br><span class="line">		Node node = (Node) dataProviderService.readOperationalData(instanceIdentifier);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> node;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Get all topologies in MD-SAL</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> List&lt;Topology&gt; <span class="title">getAllTopologies</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		 InstanceIdentifier topoIdentifier = InstanceIdentifier.builder(NetworkTopology.class).toInstance();</span><br><span class="line"></span><br><span class="line">		 System.out.println(<span class="string">"topoIdentifier "</span> + topoIdentifier);</span><br><span class="line"></span><br><span class="line">		 List&lt;Topology&gt; topos = ((NetworkTopology) <span class="keyword">this</span>.dataProviderService.readOperationalData(topoIdentifier)).getTopology();	</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> topos;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Get a particular toplogy in MD-SAL</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> Topology <span class="title">getFlowTopology</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		TopologyId topoId = <span class="keyword">new</span> TopologyId(<span class="string">"flow:1"</span>);</span><br><span class="line"></span><br><span class="line">		InstanceIdentifier topoIdentifier = InstanceIdentifier.builder(NetworkTopology.class).child(Topology.class, <span class="keyword">new</span> TopologyKey(topoId)).toInstance();</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"topoIdentifier "</span> + topoIdentifier);</span><br><span class="line"></span><br><span class="line">		Topology topology = (Topology) dataProviderService.readOperationalData(topoIdentifier);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> topology;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">// Get all links in MD-SAL</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> List&lt;Link&gt; <span class="title">getAllLinks</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		Topology flowTopology = getFlowTopology();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> flowTopology.getLink();</span><br><span class="line"></span><br><span class="line">	&#125;	</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="比较分析两种方法"><a href="#比较分析两种方法" class="headerlink" title="比较分析两种方法"></a>比较分析两种方法</h3><p><em>TODO</em></p>
<h1 id="查询拓扑信息"><a href="#查询拓扑信息" class="headerlink" title="查询拓扑信息"></a>查询拓扑信息</h1><p>最短路径dijkstra调用拓扑信息的实现如下，</p>
<ol>
<li>在activator.java中增加对拓扑管理插件（ITopologyManager）的依赖</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> org.opendaylight.controller.routing.dijkstra_implementation.internal;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Activator</span> <span class="keyword">extends</span> <span class="title">ComponentActivatorAbstractBase</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    c.add(createContainerServiceDependency(containerName).setService(ITopologyManager.class)</span><br><span class="line"></span><br><span class="line">       .setCallbacks(<span class="string">"setTopologyManager"</span>, <span class="string">"unsetTopologyManager"</span>)</span><br><span class="line"></span><br><span class="line">       .setRequired(<span class="keyword">true</span>));</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<ol>
<li>获得topologyManager实例后, 传递给本插件的实现类（DijkstraImplementation）</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"rawtypes"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DijkstraImplementation</span> <span class="keyword">implements</span> <span class="title">IRouting</span>, <span class="title">ITopologyManagerClusterWideAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTopologyManager</span><span class="params">(ITopologyManager tm)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.topologyManager = tm;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<ol>
<li>在计算路由时，通过topologyManager实例获取拓扑信息。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span><br><span class="line"></span><br><span class="line">     * Function called by dependency manager after "init ()" is called and after</span><br><span class="line"></span><br><span class="line">     * the services provided by the class are registered in the service registry</span><br><span class="line"></span><br><span class="line">     *</span><br><span class="line"></span><br><span class="line">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        log.debug(<span class="string">"Routing start() is called"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// build the routing database from the topology if it exists.</span></span><br><span class="line"></span><br><span class="line">        Map&lt;Edge, Set&lt;Property&gt;&gt; edges = topologyManager.getEdges();</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h1 id="福利"><a href="#福利" class="headerlink" title="福利"></a>福利</h1><h2 id="太子妃升职记系列"><a href="#太子妃升职记系列" class="headerlink" title="太子妃升职记系列"></a>太子妃升职记系列</h2><p><img src="http://img1.3lian.com/2015/w21/22/d/106.jpg" alt="太子妃升职记"></p>
<p><img src="http://www.mtv.net.cn/uploads/allimg/160108/41837-16010PZQT96.jpg" alt="好基友"></p>
<h1 id="风景"><a href="#风景" class="headerlink" title="风景"></a>风景</h1><p><img src="http://bbs.whnet.edu.cn/f/Picture/1460071093/1460071092260.jpg" alt="博士公寓2016-4-8 08:43:05"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://xuguan.github.io/2016/05/29/odl全局实例/" data-id="cioy4tebb000nc8ux1wzhyi48" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaCode/">javaCode</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-The-First-Day" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/29/The-First-Day/" class="article-date">
  <time datetime="2016-05-29T03:05:54.000Z" itemprop="datePublished">2016-05-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/notCode/">notCode</a>►<a class="article-category-link" href="/categories/notCode/intro/">intro</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/The-First-Day/">The First Day</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>摘要:<br>This is the first day with hexo, best wishes to the world!</p>
<p>正文:</p>
<p>This is the first day with hexo, best wishes to the world! This hexo+<a href="https://xuguan.github.io">xuguan.github.io</a> really works for a simple biography of my studies.</p>
<p><strong>try some playground contents below</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://xuguan.github.io/2016/05/29/The-First-Day/" data-id="cioy4te9q0000c8uxy6icuuyf" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/notCode/">notCode</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/29/hello-world/" class="article-date">
  <time datetime="2016-05-29T02:51:20.306Z" itemprop="datePublished">2016-05-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]<br>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
<h1 id="How-to-build-this-project"><a href="#How-to-build-this-project" class="headerlink" title="How to build this project?"></a><a href="http://blog.csdn.net/jzooo/article/details/46781805" target="_blank" rel="external">How to build this project?</a></h1><ol>
<li>$ npm install -g cnpm –registry=<a href="https://registry.npm.taobao.org" target="_blank" rel="external">https://registry.npm.taobao.org</a></li>
<li>$ cnpm install -g hexo-cli</li>
<li>$ cnpm install hexo –save</li>
<li><p>$ hexo -v</p>
</li>
<li><p>$ hexo init</p>
</li>
<li><p>$ cnpm install</p>
</li>
<li><p><code>$ hexo s -g</code></p>
</li>
<li><p>打开浏览器，输入localhost:4000,就可以在本地看到你的个人博客了 </p>
</li>
</ol>
<h2 id="上传到github"><a href="#上传到github" class="headerlink" title="上传到github"></a>上传到github</h2><ol>
<li><p><code>$ hexo new &quot;hello&quot;</code></p>
</li>
<li><p>设置git身份, 推荐用git shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">"你的用户名"</span></span><br><span class="line">$ git config --global user.email <span class="string">"你的邮箱"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>$ cnpm install hexo-deployer-git --save</code></p>
</li>
<li><code>$ hexo d -g</code></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://xuguan.github.io/2016/05/29/hello-world/" data-id="cioy4tea10001c8uxtaiqu9mq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Code/">Code</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Code/howToUse/">howToUse</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Code/script/">script</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/notCode/">notCode</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/notCode/intro/">intro</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awk/">awk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bash/">bash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grep/">grep</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javaCode/">javaCode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/notCode/">notCode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tcpdump/">tcpdump</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/awk/" style="font-size: 10px;">awk</a> <a href="/tags/bash/" style="font-size: 10px;">bash</a> <a href="/tags/grep/" style="font-size: 10px;">grep</a> <a href="/tags/javaCode/" style="font-size: 10px;">javaCode</a> <a href="/tags/notCode/" style="font-size: 10px;">notCode</a> <a href="/tags/tcpdump/" style="font-size: 10px;">tcpdump</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/06/02/monitorHTTP/">monitorHTTP</a>
          </li>
        
          <li>
            <a href="/2016/05/29/odl全局实例/">odl全局实例</a>
          </li>
        
          <li>
            <a href="/2016/05/29/The-First-Day/">The First Day</a>
          </li>
        
          <li>
            <a href="/2016/05/29/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Guan<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>